//from auth.js
function signUp(email, password, username) {
  auth.createUserWithEmailAndPassword(email, password)
    .then(userCredential => {
      // Save user info in Firestore
      return db.collection('users').doc(userCredential.user.uid).set({
        username: username,
        email: email,
        avatarUrl: ''
      });
    })
    .then(() => console.log('User registered!'))
    .catch(err => console.error(err));
}

// ---- LOGIN ----
function logIn(email, password) {
  auth.signInWithEmailAndPassword(email, password)
    .then(userCredential => console.log('Logged in:', userCredential.user))
    .catch(err => console.error(err));
}

// ---- POST ARTWORK ----
async function postArtwork(file, title, description) {
  const storageRef = storage.ref('artworks/' + file.name);
  await storageRef.put(file);
  const imageUrl = await storageRef.getDownloadURL();

  await db.collection('artworks').add({
    authorId: auth.currentUser.uid,
    title: title,
    description: description,
    imageUrl: imageUrl,
    likes: [],
    comments: [],
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  });

  console.log('Artwork posted!');
}

// ---- DISPLAY GALLERY ----
db.collection('artworks').orderBy('createdAt', 'desc')
  .onSnapshot(snapshot => {
    snapshot.docs.forEach(doc => {
      const art = doc.data();
      console.log(art.title, art.imageUrl);
      // Insert into your HTML gallery
    });
  });




  //from script.js
  
// Auth Functions
function showLogin() {
  isLoginMode = true;
  updateAuthModal();
  document.getElementById('auth-modal').classList.add('active');
}

function showSignup() {
  isLoginMode = false;
  updateAuthModal();
  document.getElementById('auth-modal').classList.add('active');
}

function hideAuth() {
  document.getElementById('auth-modal').classList.remove('active');
}

function updateAuthModal() {
  const title = document.getElementById('auth-title');
  const subtitle = document.getElementById('auth-subtitle');
  const submitBtn = document.getElementById('auth-submit-btn');
  const toggleBtn = document.getElementById('auth-toggle');
  const nameField = document.getElementById('name-field');
  
  if (isLoginMode) {
    title.textContent = 'Welcome Back';
    subtitle.textContent = 'Continue your healing journey';
    submitBtn.textContent = 'Sign In';
    toggleBtn.textContent = "Don't have an account? Sign up";
    nameField.style.display = 'none';
  } else {
    title.textContent = 'Join the Community';
    subtitle.textContent = 'Start your transformation today';
    submitBtn.textContent = 'Sign Up';
    toggleBtn.textContent = 'Already have an account? Sign in';
    nameField.style.display = 'block';
  }
}


